<?xml version="1.0" encoding="UTF-8"?>
<panel>
  <row>
      <box title="Specimen">
        <item title="Number of Specimens">
            <sql>
                <statement row="1" col="1">
                  <![CDATA[select count(*) from collectionobj]]>
                </statement>
            </sql>
        </item>
        <item title="Type Specimens">
            <sql>
                <statement row="1" col="1">
                  <![CDATA[select count(determinationid) from determination where TypeStatusName is not null]]>
                </statement>
            </sql>
        </item>
        <item title="Unique Families">
            <sql>
                <statement>
                  <![CDATA[xcreate temporary table UniqueFamilies select (select lev.taxonnameid from taxonname as lev where lev.rankid = 140 and tax.nodenumber between lev.nodenumber and lev.HighestChildNodeNumber LIMIT 1)  as txids from taxonname as tax where tax.accepted <> 0 and tax.taxonnameid in (select taxonnameid from determination where current1 <> 0)]]>
                </statement>
                <statement row="1" col="1">
                  <![CDATA[select count(taxonnameid) from taxonname,UniqueFamilies where taxonname.taxonnameid = UniqueFamilies.txids]]>
                </statement>
                <statement>
                  <![CDATA[drop table UniqueFamilies]]>
                </statement>
            </sql>
        </item>
        <item title="Unique Genera">
            <sql>
                <statement>
                  <![CDATA[xcreate temporary table UniqueGenera select (select lev.taxonnameid from taxonname as lev where lev.rankid = 180 and tax.nodenumber between lev.nodenumber and lev.HighestChildNodeNumber LIMIT 1)  as txids from taxonname as tax where tax.accepted <> 0 and tax.taxonnameid in (select taxonnameid from determination where current1 <> 0)]]>
                </statement>
                <statement row="1" col="1">
                  <![CDATA[select count(taxonnameid) from taxonname,UniqueGenera where taxonname.taxonnameid = UniqueGenera.txids]]>
                </statement>
                <statement>
                  <![CDATA[drop table UniqueGenera]]>
                </statement>
            </sql>
        </item>
        <item title="Unique Species">
            <sql>
                <statement>
                  <![CDATA[xcreate temporary table UniqueSpecies select (select lev.taxonnameid from taxonname as lev where lev.rankid = 220 and tax.nodenumber between lev.nodenumber and lev.HighestChildNodeNumber LIMIT 1)  as txids from taxonname as tax where tax.accepted <> 0 and tax.taxonnameid in (select taxonnameid from determination where current1 <> 0)]]>
                </statement>
                <statement row="1" col="1">
                  <![CDATA[select count(taxonnameid) from taxonname,UniqueSpecies where taxonname.taxonnameid = UniqueSpecies.txids]]>
                </statement>
                <statement>
                  <![CDATA[drop table UniqueSpecies]]>
                </statement>
            </sql>
        </item>
        <item title="Taxa in Collection">
            <sql><statement><![CDATA[select count(taxonnameid) AS TaxaInCollectionCount from taxonname where taxonnameid in (select taxonnameid from determination where current1 <> 0)]]></statement></sql>
        </item>        
      </box>
      <box title="Data Entry">
        <item title="Cataloged in Last 7 Days">
            <sql><statement><![CDATA[select count(*) from collectionobjectcatalog where subnumber = 0 and DATE_SUB(CURDATE(), INTERVAL 7 DAY) <= TimestampCreated]]></statement></sql>
            <link>CatalogedLast7DaysDetail</link>
        </item>
        <item title="Cataloged in Last 30 Days">
            <sql><statement><![CDATA[select count(*) from collectionobjectcatalog where subnumber = 0 and DATE_SUB(CURDATE(), INTERVAL 1 MONTH) <= TimestampCreated]]></statement></sql>
            <link>CatalogedLastMonth</link>
        </item>
        <item title="Cataloged in Last Year">
            <sql><statement><![CDATA[select count(*) from collectionobjectcatalog WHERE subnumber = 0 and DATE_SUB(CURDATE(), INTERVAL 1 YEAR) <= TimestampCreated;]]></statement></sql>
            <link>CatalogedLastYear</link>
        </item>
      </box>
  </row>
  <row>
      <box title="Loans">
        <item title="Items On Loan">
            <sql><statement><![CDATA[select count(loanphysicalobjectid) AS ItemsOnLoanCount from loanphysicalobject as lpo inner join loan on loan.loanid = lpo.loanid where loan.category = 0 and quantityresolved < quantity and (closed = 0 or closed is null)]]></statement></sql>
        </item>
        <item title="Overdue Loans">
            <sql><statement><![CDATA[select count(loanid) as OpenLoanCount from loan where loanid in (select loanid from loan where (not (currentduedate is null)) and category = 0 and (closed = 0 or closed is null) and datediff(CURDATE(), currentduedate) > 0)]]></statement></sql>
            <link>OverdueLoansList</link>
        </item>
        <item title="Open Loans">
            <sql><statement><![CDATA[select count(loanid) as OpenLoanCount from loan where category = 0 and (closed = 0 or closed is null)]]></statement></sql>
            <link>ListOnLoan</link>
        </item>
      </box>
      <box title="Locality/Geography">
        <item title="Number of Localities">
            <sql><statement><![CDATA[select count(*) from locality]]></statement></sql>
        </item>
        <item title="Number of Geographies">
            <sql><statement><![CDATA[select count(*) from geography]]></statement></sql>
        </item>
        <item title="Number of Countries">
            <sql><statement><![CDATA[select count(country) AS CountryCount from (select distinct country from geography as g inner join locality as l on l.geographyid = g.geographyid inner join collectingevent as ce on ce.localityid = l.localityid inner join collectionobject as co on co.collectingeventid = ce.collectingeventid) AS UCountries;]]></statement></sql>
        </item>
        <item title="Percent Geo Referenced">
            <sql><statement><![CDATA[]]>select CASE WHEN (select count(*) from locality) = 0 THEN 0 ELSE ((count(localityid) * 1.0) / ((select count(*) from locality) * 1.0)) * 100.0 END AS PercentGeoReferencedLocalities from locality where not latitude1 is null;</statement></sql>
        </item>
    </box>
  </row>
  <row>
    <box title="Taxonomic Tree Information">    
        <item title="Class">
            <sql><statement><![CDATA[select count(*) from taxonname where taxonname.rankid = 60]]></statement></sql>
        </item>
        <item title="Order">
            <sql><statement><![CDATA[select count(*) from taxonname where taxonname.rankid = 100]]></statement></sql>
        </item>
        <item title="Families">
            <sql><statement><![CDATA[select count(*) from taxonname where taxonname.rankid = 140]]></statement></sql>
        </item>
        <item title="Genera">
            <sql><statement><![CDATA[select count(*) from taxonname where taxonname.rankid = 180]]></statement></sql>
        </item>
        <item title="Species">
            <sql><statement><![CDATA[select count(*) from taxonname where taxonname.rankid = 220]]></statement></sql>
        </item>
    </box>
    <box title="Taxa Type Counts" descCol="1" valCol="2">    
		<sql><![CDATA[select TypeStatusName, count(determinationid) AS DeterminationCount from determination where TypeStatusName is not null group by TypeStatusName]]></sql>
    </box>
  </row>
  <row>
    <box title="Taxa Type Counts" descCol="1" valCol="2">    
		<sql><![CDATA[select CollectionObjectTypeName, ObjectCount from (select CollectionObjectTypeID AS ObjectType, Count(CollectionObjectID) AS ObjectCount from collectionobject Group By CollectionObjectTypeID) AS T2, collectionobjecttype where T2.ObjectType = collectionobjecttype.CollectionObjectTypeID]]></sql>
    </box>
  </row>
</panel>
