<?xml version="1.0" encoding="UTF-8"?>
<panel>
    <!--
  <row>
      <box title="Task List" desccol="1" valcol="2">    
		<sql><![CDATA[Select name from tasklist]]></sql>
      </box>
      <box title="Pre-Catalog Works Benches" desccol="1" valcol="2">    
		<sql><![CDATA[Select name from workbench]]></sql>
      </box>
  </row>
   <row>
      <box title="Loans">
        <item title="Items On Loan">
            <sql><statement><![CDATA[select count(loanphysicalobjectid) AS ItemsOnLoanCount from loanphysicalobject as lpo inner join loan on loan.loanid = lpo.loanid where loan.category = 0 and quantityresolved < quantity and (closed = 0 or closed is null)]]></statement></sql>
        </item>
        <item title="Overdue Loans">
            <sql><statement><![CDATA[select count(loanid) as OpenLoanCount from loan where loanid in (select loanid from loan where (not (currentduedate is null)) and category = 0 and (closed = 0 or closed is null) and datediff(CURDATE(), currentduedate) > 0)]]></statement></sql>
            <link>OverdueLoansList</link>
        </item>
        <item title="Open Loans">
            <sql><statement><![CDATA[select count(loanid) as OpenLoanCount from loan where category = 0 and (closed = 0 or closed is null)]]></statement></sql>
            <link>ListOnLoan</link>
        </item>
      </box>
      <box title="Overdue Loans" desccol="1" valcol="5">    
		  <sql><![CDATA[Select distinct loan.LoanNumber as LoanNumber, loan.LoanDate, loan.CurrentDueDate, agent.FirstName, agent.LastName, loan.loanid, loan.OriginalDueDate, loanphysicalobject.Quantity, loanphysicalobject.DescriptionOfMaterial, address.Address, address.City, address.State, address.Country From loan Inner Join loanphysicalobject ON loan.LoanID =  loanphysicalobject.LoanID Inner Join loanagents ON loan.LoanID = loanagents.LoanID Inner Join agentaddress ON loanagents.AgentAddressID = agentaddress.AgentAddressID Inner Join address ON agentaddress.AddressID = address.AddressID Inner Join agent ON agentaddress.AgentID = agent.AgentID where loan.loanid in (select loanid from loan where (not  (currentduedate is null)) and category = 0 and (closed = 0 or closed is null) and datediff(CURDATE(), currentduedate) > 0)  group by LoanNumber]]></sql>
		  <link colid="6">OverdueLookup</link>
      </box>
   </row> 
    <row>
        <box title="Recent Searches" desccol="1" valcol="2">    
		<sql><![CDATA[Select name from searches]]></sql>
      </box>
  
      <box title="Data Entry">
        <item title="Cataloged in Last 7 Days">
            <sql><statement><![CDATA[select count(*) from collectionobject where DATE_SUB(CURDATE(), INTERVAL 7 DAY) <= TimestampCreated]]></statement></sql>
            <link>CatalogedLast7DaysDetail</link>
        </item>
        <item title="Cataloged in Last 30 Days">
            <sql><statement><![CDATA[select count(*) from collectionobject where DATE_SUB(CURDATE(), INTERVAL 1 MONTH) <= TimestampCreated]]></statement></sql>
            <link>CatalogedLastMonth</link>
        </item>
        <item title="Cataloged in Last Year">
            <sql><statement><![CDATA[select count(*) from collectionobject WHERE DATE_SUB(CURDATE(), INTERVAL 1 YEAR) <= TimestampCreated;]]></statement></sql>
            <link>CatalogedLastYear</link>
        </item>
      </box>
  </row>
  -->
    <row>
        <box title="Accessions Entered in the Last 3 Months" desccol="1" valcol="3">
            <sql><![CDATA[select number, accessionId, TimestampCreated From accession where DATE_SUB(CURDATE(), INTERVAL 3 MONTH) <= TimestampCreated order by TimestampCreated desc]]></sql>
            <link colid="2">Accession</link>
        </box>
        <box title="Permits Entered in the Last 3 Months" desccol="1" valcol="3">
            <sql><![CDATA[select permit.PermitNumber, permit.PermitID, permit.EndDate From permit where DATE_SUB(CURDATE(), INTERVAL 3 MONTH) <= TimestampCreated order by permitNumber asc]]></sql>
            <link colid="2">CITESPermitsExpireThisYear</link>
        </box>
    </row> 
    
    <row>
        <box title="CITES Permits Expiring This Year" desccol="1" valcol="3">
            <sql><![CDATA[select permit.PermitNumber, permit.PermitID, permit.EndDate From permit where ( lower(Type) like '%CITES%') and year(CURDATE()) = year(EndDate)]]></sql>
            <link colid="2">CITESPermitsExpireThisYear</link>
        </box>
        <box title="Non-CITES Permits Expiring This Year" desccol="1" valcol="3">
            <sql><![CDATA[select permit.PermitNumber, permit.PermitID, permit.EndDate From permit where ( lower(Type) not like '%CITES%') and year(CURDATE()) = year(EndDate)]]></sql>
            <link colid="2">NonCITESPermitsExpireThisYear</link>
        </box>
    </row>
    
    <row>
        <box type="Bar Chart" name="AccessionByDivision" colspan="3"/>
    </row> 
    
</panel>
